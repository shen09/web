$(function(){var emoji=null;var maxImg=false;if($(".post-content table").length>0){for(var i=0;i<$(".post-content table").length;i++){var table='<div class="table-responsive"><table class="table table-striped table-bordered table-hover">'+$(".post-content table").eq(i).html()+"</table></div>";$(".post-content table").eq(i).replaceWith(table)}}$(".article-page article img").on("click",function(){$("#max-img").css("display","block");setTimeout(function(){$("#max-img").css("opacity",1);$("#max-img img").css({"max-width":"90%","max-height":"90%"})});$("#max-img img").attr({"src":$(this).attr("src"),"alt":$(this).attr("alt")});$(".hide-img").focus();maxImg=true});$("#max-img").on("click",function(){$("#max-img").css("opacity",0);$("#max-img img").css({"max-width":0,"max-height":0});setTimeout(function(){$("#max-img").css("display","none");$("#max-img img").attr("src","")},300);maxImg=false});if($(".post-content a").length){$(".post-content a").attr("target","_blank");$(".post-content a").addClass($(".post-content").attr("data-color"))}if($(".pagination-nav ul li").length>0){$(".pagination-nav ul li").addClass("page-item");$(".pagination-nav ul li a").addClass("page-link");$(".pagination-nav .prev a").attr("aria-label","上一页");$(".pagination-nav .next a").attr("aria-label","下一页")}if($(".icon-folder-open").length){$(".icon-folder-open").nextAll().attr({"title":"分类","data-toggle":"tooltip","data-placement":"top"});$(".icon-folder-open").nextAll().addClass($(".icon-folder-open").attr("data-color"))}if($(".tags a").length){$(".tags a").attr({"title":"标签","data-toggle":"tooltip","data-placement":"top"});$(".tags a").addClass($(".tags").attr("data-color"))}if($(".comment-info b a").length>0){$(".comment-info b a").attr("target","_blank")}if($(".comments-lists .page-navigator").length>0){$(".comments-lists .page-navigator li").addClass("pagination");$(".comments-lists .page-navigator li a").addClass("page-link");var pageNav='<nav aria-label="分页导航区"><ol class="pagination justify-content-center page-navigator">'+$(".comments-lists .page-navigator").html()+"</ol></nav>";$(".comments-lists .page-navigator").replaceWith(pageNav)}if($(".latest-articles a").eq(0).children(".article-img").length>0){$(".latest-articles a").eq(0).addClass("latest-articles-active")}$(".latest-articles li").on("mouseover",function(ev){ev.preventDefault();ev.stopPropagation();if($(this).children("a").children(".article-img").length>0){$(".latest-articles a").removeClass("latest-articles-active");$(this).children("a").addClass("latest-articles-active")}});$(".latest-articles").on("mouseout",function(ev){var x=ev.clientX;var y=ev.clientY+$(document).scrollTop();if(x<$(this).offset().left||x>=$(this).offset().left+$(this).width()||y<$(this).offset().top||y>=$(this).offset().top+$(this).height()){$(".latest-articles a").removeClass("latest-articles-active");if($(".latest-articles a").eq(0).children(".article-img").length>0){$(".latest-articles a").eq(0).addClass("latest-articles-active")}}});if($(".post-content .protected").length>0){$(".protected .word").attr("role","alert");$(".protected .text").attr("placeholder","请在此处输入文章密码");$(".protected .text").get(0).select()}$("#show-emoji").on("click",function(){if($(this).attr("aria-expanded")&&emoji==null){$.post($("#show-emoji").attr("url"),"emoji=emoji",function(data){emoji=JSON.parse(data);$("#emoji-box .emoji-classification button").eq(0).click()})}});for(var i=0;i<$("#emoji-box .emoji-classification button").length;i++){$("#emoji-box .emoji-classification button").eq(i).on("click",function(){if(emoji==null){return false}$("#emoji-box .emoji-classification button").removeClass("active");$(this).addClass("active");var emojiDOM="";emoji[$(this).attr("classification")].forEach(function(val){emojiDOM+='<div class="float-left emoji" tabindex="0" role="button">'+val+"</div>"});$("#emoji-box .emoji-select").html("");$("#emoji-box .emoji-select").append(emojiDOM)})}$("#emoji-box .emoji-select").on("click",".emoji",function(){$("#textarea").val($("#textarea").val()+$(this).html())});$("#emoji-box .emoji-select").on("keypress",".emoji",function(ev){if(ev.keyCode==13){$(this).click()}});$(".to-top").on("click",function(){$("header .navbar-brand").get(0).focus();$(document).scrollTop(0)});$(document).on("scroll",function(){if($(".to-top").length>0){if($(document).scrollTop()>window.innerHeight){$(".to-top").removeClass("d-none")}else{$(".to-top").addClass("d-none")}}if(maxImg){$("#max-img").click()}});$(".hide-img").on("keypress",function(ev){if(ev.keyCode==13){$("#max-img").click()}});$(document).on("keyup",function(ev){if(ev.keyCode==27&&maxImg){$("#max-img").click()}});if($("#qrcode").length>0){$("#qrcode").qrcode({width:235,height:235,text:$("#share-btn").attr("data-url")});if($("#qrcode img").length>0){$("#qrcode img").attr("alt","文章二维码")}}$("#agree-btn").on("click",function(){$("#agree-btn").get(0).disabled=true;$.ajax({type:"post",url:$("#agree-btn").attr("data-url"),data:"agree="+$("#agree-btn").attr("data-cid"),async:true,timeout:30000,cache:false,success:function(data){var re=/\d/;
if(re.test(data)){$("#agree-btn .agree-num").html(data);$(".post-page").append('<span id="agree-p">赞 + 1</span>');$("#agree-p").css({top:$("#agree-btn").offset().top-25,left:$("#agree-btn").offset().left+$("#agree-btn").outerWidth()/2-$("#agree-p").outerWidth()/2});$("#agree-p").animate({top:$("#agree-btn").offset().top-70,opacity:0},400,function(){$("#agree-p").remove()})}},error:function(){$("#agree-btn").get(0).disabled=false}})});$('[data-toggle="tooltip"]').tooltip();if($("#comments .parent").length){var linkColor=$(".post-content").attr("data-color");for(var i=0;i<$("#comments .parent").length;i++){var parentLink='<a class="mr-1 '+linkColor+'" href="'+$("#comments .parent").eq(i).attr("href")+'">'+$("#comments .parent").eq(i).html()+"</a>";$("#comments .parent").eq(i).next().prepend(parentLink)}$("#comments .parent").remove()}if($(".post-content").length>0&&$(".post-content").attr("data-atalog")){if($(".post-content h2").length<1&&$(".post-content h3").length<1&&$(".post-content h4").length<1&&$(".post-content h5").length<1){return false}$(".post-content h2").addClass("content-title");$(".post-content h3").addClass("content-title");$(".post-content h4").addClass("content-title");$(".post-content h5").addClass("content-title");$(".post-content h2").attr("data-index",2);$(".post-content h3").attr("data-index",3);$(".post-content h4").attr("data-index",4);$(".post-content h5").attr("data-index",5);var el=atalog(2,0);$(".post-content").prepend('<div class="pt-2 pb-2 atalog"><h2>目录</h2>'+el.el+"</div>");$(".post-content .atalog").children("ul").attr("aria-label","目录")}$(".post-content .atalog a").on("click",function(){$(document).scrollTop(Number($(".content-title").eq($(this).attr("data-index")).offset().top)-60)});if($(".post-content a").length){$(".post-content a").addClass($(".post-content").attr("data-color"))}if($(".post-navigation a").length){$(".post-navigation a").addClass($(".post-content").attr("data-color"))}if($(".comment-info .author a").length){$(".comment-info .author a").addClass($(".post-content").attr("data-color"))}if($("#cancel-comment-reply-link").length){$("#cancel-comment-reply-link").addClass($(".post-content").attr("data-color"))}if($("body").attr("data-rounded")==="rounded-0"){if($(".pagination-nav .pagination a").length){$(".pagination-nav .pagination a").addClass($("body").attr("data-rounded"))}if($(".comment-author .comment-reply a").length){$(".comment-author .comment-reply a").addClass($("body").attr("data-rounded"))}}});function atalog(titleIndex,start){var el={el:"",index:start};var current=0;for(var i=start;i<$(".content-title").length;i++){if(i<current){continue}if($(".content-title").eq(i).attr("data-index")>titleIndex){var result=atalog($(".content-title").eq(i).attr("data-index"),i);if(result.el!=""){el.el+="<li> "+result.el+"</li>"}current=result.index+1;el.index=result.index;continue}if($(".content-title").eq(i).attr("data-index")<titleIndex){if(el.el!=""){el.el='<ul class="mb-2">'+el.el+"</ul>"}return el}el.el+='<li><a data-index="'+i+'" href="javascript:;">'+$(".content-title").eq(i).text()+"</a></li>";el.index=i}if(el.el!=""){el.el='<ul class="mb-2"> '+el.el+"</ul>"}return el}hljs.initHighlightingOnLoad();